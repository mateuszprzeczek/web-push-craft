<div class="creator-container">
  <div class="d-flex justify-content-between align-items-center mb-4">
    <h1 class="mb-0">{{ 'creator.title' | translate }}</h1>
    <a routerLink="/templates" class="btn btn-outline-secondary">
      <mat-icon class="me-1">arrow_back</mat-icon>
      {{ 'creator.backToTemplates' | translate }}
    </a>
  </div>

  <mat-card class="creator-content">
    <p class="mb-4">{{ 'creator.description' | translate }}</p>

    <form [formGroup]="templateForm" (ngSubmit)="saveTemplate()">
      <div class="row">
        <div class="col-md-6 mb-3">
          <mat-form-field class="w-100">
            <mat-label>{{ 'creator.form.name' | translate }}</mat-label>
            <input matInput formControlName="name" required>
            @if (templateForm.get('name')?.hasError('required')) {
              <mat-error>
                {{ 'creator.form.nameRequired' | translate }}
              </mat-error>
            }
          </mat-form-field>
        </div>
      </div>

      <h3 class="mt-4 mb-3">{{ 'creator.form.notificationDetails' | translate }}</h3>

      <div class="row">
        <div class="col-md-6 mb-3">
          <mat-form-field class="w-100">
            <mat-label>{{ 'creator.form.title' | translate }}</mat-label>
            <input matInput formControlName="title" required>
            @if (templateForm.get('title')?.hasError('required')) {
              <mat-error>
                {{ 'creator.form.titleRequired' | translate }}
              </mat-error>
            }
          </mat-form-field>
        </div>

        <div class="col-md-6 mb-3">
          <div
            class="drop-zone"
            [class.active]="isDraggingIcon()"
            (dragover)="onDragOverIcon($event)"
            (dragleave)="onDragLeaveIcon($event)"
            (drop)="onDropIcon($event)">
            <mat-form-field class="w-100">
              <mat-label>{{ 'creator.form.icon' | translate }}</mat-label>
              <input matInput formControlName="icon" placeholder="https://example.com/icon.png">
              <mat-hint>{{ 'creator.form.iconHint' | translate }}</mat-hint>
            </mat-form-field>
            <div class="drop-zone-overlay">
              <mat-icon>cloud_upload</mat-icon>
              <span>{{ 'creator.form.dropIconHere' | translate }}</span>
            </div>
          </div>
        </div>
      </div>

      <div class="row">
        <div class="col-12 mb-3">
          <mat-form-field class="w-100">
            <mat-label>{{ 'creator.form.body' | translate }}</mat-label>
            <textarea matInput formControlName="body" rows="3" required></textarea>
            @if (templateForm.get('body')?.hasError('required')) {
              <mat-error>
                {{ 'creator.form.bodyRequired' | translate }}
              </mat-error>
            }
          </mat-form-field>
        </div>
      </div>

      <h3 class="mt-4 mb-3">{{ 'creator.form.notificationButtons' | translate }}</h3>

      @if (isButton1Visible()) {
        <div class="notification-button-group">
          <div class="button-title-container">
            <div class="button-title">{{ 'creator.form.button1Label' | translate }}</div>
            <button type="button" class="remove-button" (click)="removeButton1()" matTooltip="{{ 'creator.form.removeButton' | translate }}">
              <mat-icon>close</mat-icon>
            </button>
          </div>
          <div class="row">
            <div class="col-md-6 mb-3">
              <mat-form-field class="w-100">
                <mat-label>{{ 'creator.form.btn1Title' | translate }}</mat-label>
                <input matInput formControlName="btn1Title" placeholder="Click here">
                <mat-hint>{{ 'creator.form.btn1TitleHint' | translate }}</mat-hint>
              </mat-form-field>
            </div>

            <div class="col-md-6 mb-3">
              <mat-form-field class="w-100">
                <mat-label>{{ 'creator.form.btn1Url' | translate }}</mat-label>
                <input matInput formControlName="btn1Url" placeholder="https://example.com/action1">
                <mat-hint>{{ 'creator.form.btn1UrlHint' | translate }}</mat-hint>
              </mat-form-field>
            </div>
          </div>
        </div>
      } @else {
        <div class="add-button-container" (click)="addButton1()">
          <mat-icon>add_circle</mat-icon>
          <span>{{ 'creator.form.addButton' | translate }} 1</span>
        </div>
      }

      @if (isButton2Visible()) {
        <div class="notification-button-group">
          <div class="button-title-container">
            <div class="button-title">{{ 'creator.form.button2Label' | translate }}</div>
            <button type="button" class="remove-button" (click)="removeButton2()" matTooltip="{{ 'creator.form.removeButton' | translate }}">
              <mat-icon>close</mat-icon>
            </button>
          </div>
          <div class="row">
            <div class="col-md-6 mb-3">
              <mat-form-field class="w-100">
                <mat-label>{{ 'creator.form.btn2Title' | translate }}</mat-label>
                <input matInput formControlName="btn2Title" placeholder="Learn more">
                <mat-hint>{{ 'creator.form.btn2TitleHint' | translate }}</mat-hint>
              </mat-form-field>
            </div>

            <div class="col-md-6 mb-3">
              <mat-form-field class="w-100">
                <mat-label>{{ 'creator.form.btn2Url' | translate }}</mat-label>
                <input matInput formControlName="btn2Url" placeholder="https://example.com/action2">
                <mat-hint>{{ 'creator.form.btn2UrlHint' | translate }}</mat-hint>
              </mat-form-field>
            </div>
          </div>
        </div>
      } @else {
        <div class="add-button-container" (click)="addButton2()">
          <mat-icon>add_circle</mat-icon>
          <span>{{ 'creator.form.addButton' | translate }} 2</span>
        </div>
      }

      <h3 class="mt-4 mb-3">{{ 'creator.form.additionalOptions' | translate }}</h3>

      <div class="row">
        <div class="col-md-6 mb-3">
          <mat-form-field class="w-100">
            <mat-label>{{ 'creator.form.badge' | translate }}</mat-label>
            <input matInput formControlName="badge" placeholder="https://example.com/badge.png">
            <mat-hint>{{ 'creator.form.badgeHint' | translate }}</mat-hint>
          </mat-form-field>
        </div>
      </div>

      <div class="row">
        <div class="col-md-6 mb-3">
          <div
            class="drop-zone"
            [class.active]="isDraggingImage()"
            (dragover)="onDragOverImage($event)"
            (dragleave)="onDragLeaveImage($event)"
            (drop)="onDropImage($event)">
            <mat-form-field class="w-100">
              <mat-label>{{ 'creator.form.image' | translate }}</mat-label>
              <input matInput formControlName="image" placeholder="https://example.com/image.jpg">
              <mat-hint>{{ 'creator.form.imageHint' | translate }}</mat-hint>
            </mat-form-field>
            <div class="drop-zone-overlay">
              <mat-icon>cloud_upload</mat-icon>
              <span>{{ 'creator.form.dropImageHere' | translate }}</span>
            </div>
          </div>
        </div>

        <div class="col-md-6 mb-3">
          <mat-form-field class="w-100">
            <mat-label>{{ 'creator.form.tag' | translate }}</mat-label>
            <input matInput formControlName="tag">
            <mat-hint>{{ 'creator.form.tagHint' | translate }}</mat-hint>
          </mat-form-field>
        </div>
      </div>

      <div class="d-flex justify-content-end mt-4">
        <button type="button" mat-button routerLink="/templates" class="me-2">
          {{ 'creator.form.cancel' | translate }}
        </button>
        <button type="submit" mat-raised-button color="primary" [disabled]="isSubmitting()">
          <mat-icon class="me-1">save</mat-icon>
          {{ 'creator.form.save' | translate }}
        </button>
      </div>
    </form>
  </mat-card>
</div>
